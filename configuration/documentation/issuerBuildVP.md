# Verifiable presentations

A verifiable presentation is a tamper-evident presentation encoded in such a way that authorship of the data can be trusted after a verification process.

Any credential can be issued as a verifiable presentation by selecting the appropiate option at the EDCI issuer. Also, a wallet-stored credential can be exported and embedded into a credential. 

Holders of europass credentials can generate verifiable presentations and then share these with verifiers to prove they possess credentials with certain characteristics.
## Table of Contents
- [Types](#Types)
- [Verifiable Presentation structure](#Verifiable-Presentation-structure)
- [Issuing a Verifiable Presentation](#Issuing a Verifiable Presentation)

## Types 

These are three types of verifiable presentation that can be issued, depending on how it was issued: 

* **Mandated Issue** - Generated by the EDCI Issuer while issuing a credential.

* **Notarised Copy** - Produced by a Public Notary, that has personally verified the information of the credential with the awarding institution.

* **Shared Credential** - Exported representation of a credential (or mandated issue) stored inside a wallet or opened using the EDCI Viewer

## Verifiable Presentation structure
[Here](https://github.com/european-commission-europass/Europass-Learning-Model) you can find the europass data model, also in this document you will find a list of all the specific elements of a verifiable presentation. 
You can find the specific verifiable presentation XSD for this [here](https://github.com/european-commission-europass/Europass-Learning-Model/tree/master/Credentials/XSD/flatten).

## Verifiable Presentation fields
In this section you will find a list of the fields that are directly under the root tag of the verifiable presentation. 

These fields belong to the Verifiable Presentation datamodel, and not to the Europass Credential datamodel, this means that valid fields for the credentials will not be valid under the root tag of a verifiable pesentation.

### verifiablePresentation
Root element of the verifiable presentation, it contains an **id** attribute with a pseudo-random URI in addition to all the namespace definitions.

Also, the schemaLocation attribute of this tag will define the XSD used for validation.

### type
Element used to identify the type of the verifiable presentation (Mandated issue, Notarised Copy or Shared Credential). It consists of a Code entity meaning that it can be stored in a controlled list.

### expirationDate
A date field containing the expiration date of the verifiable presentation, that will not be valid after that date.

### issuer
The organisation that issued the credential and sealed it with their digital e-seal. This field is the only one that is shared accross the Europass Credential and Verifiable Presentation datamodel, as an Organisation will have the same fields in both models.

### verifications
The evaluation of whether a verifiable credential or verifiable presentation is an authentic valid or has the correct format. It includes the following verification checks:
* **format** - Checks if the format of the credential is correct. 
* **seal** - Checks if this credential has not been tampered with since issue.
* **revocation** - Verifies if the credential has been revocated by checking the credential with revocation lists.
* **authorization** - Checks if the issuing organisation is legally authorised to issue this kind of credential.
* **validity** - Checks the expiration date of the credential and verifiable presentation to determine if the credential is valid to this day.

### Custom checks
A verifiable presentation may contain one or many custom checks,those are custom validations that are independent from the signature checks and can be applied by the sealing Organisation.
 

### europassCredential
This field must contain a valid Europass Credential, wich is the base for the Verifiable Presentation, in XML format and without a cryptographic proof.

The Credential can contain all of the fields defined in the [europass data model](https://github.com/european-commission-europass/Europass-Learning-Model) 

### proof
The cryptographic proofs that can be used to detect tampering and verify the authorship of the presentation.

## Issuing a Verifiable Presentation

#### Custom Checks

When issuing a verifiable presentation with custom checks, those must be defined in the uploaded XML, following the Code Entity XML format.

Find below an example of the format, containing a single verification check:

``` xml

      <vp:verificationCheck>
         <vp:type targetFrameworkUrl="http://data.europa.eu/snb/verification/25831c2" uri="http://data.europa.eu/snb/verification/c_50990fe3">
            <targetName>
               <text content-type="text/plain" lang="en">Custom</text>
               <text content-type="text/plain" lang="es">Personalizado</text>
            </targetName>
            <targetFrameworkName>
               <text content-type="text/plain" lang="en">Europass Standard List of Verification Types</text>
            </targetFrameworkName>
         </vp:type>        
         <vp:status targetFrameworkUrl="http://data.europa.eu/snb/verification-status/25831c2" uri="http://data.europa.eu/snb/verification-status/9895008394">
            <targetName>
               <text content-type="text/plain" lang="en">green</text>
               <text content-type="text/plain" lang="es">verde</text>
            </targetName>
            <targetFrameworkName>
               <text content-type="text/plain" lang="en">Europass Standard List of Verification Statusses</text>
            </targetFrameworkName>
         </vp:status>
         <vp:description>
            <text content-type="text/plain" lang="en">This is a custom verification check</text>
         </vp:description>
      </vp:verificationCheck>

``` 

#### Proof

When issuing a verifiable presentation, both the verifiable presentation and europass credential entities residing in the XML must be unsigned, otherwise the presentation will be invalidated at issuing time.